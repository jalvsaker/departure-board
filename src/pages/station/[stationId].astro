---
import Layout from "../../layouts/Layout.astro";
import { DepartureBoard } from "../../components/DepartureBoard";
import { fetchDepartures } from "../../utils/entur";

export const prerender = false;

const { stationId } = Astro.params;
if (!stationId) throw new Error("");
const res = await fetchDepartures(stationId);

if (!res) {
  return new Response("Not found", {
    status: 404,
    statusText: "Not Found",
  });
}
---

<Layout title="Station deps">
  <DepartureBoard
    station={stationId}
    stationName={res?.name}
    initialDepartures={res?.departures || []}
    client:load
  />
</Layout>
